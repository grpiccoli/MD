document.addEventListener("DOMContentLoaded",function(){var u="Input_CarnetId",n=$("#Input_RUT"),t=$("#Input_Name"),i=$("#"+u),o=$("#Input_Email"),r=7,f=t.parent(),e=i.parent();new Cleave("#"+u,{delimiter:".",blocks:[3,3,3],uppercase:!0});Parsley.addValidator("rut",{validateString:function(u){n.val(u.replace(/k/,"K"));var o,s,h=$.validateRut(u,function(n,t){o=n;s=t},{minimumLength:r});return!h||o>3e7?!1:(loaderStart(),fetch("/SP/validaterut",{method:"POST",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}),body:"__RequestVerificationToken="+$('input[name="__RequestVerificationToken"]').val()+("&rut="+o)+("&dv="+s.replace(/k/,"K"))}).then(function(n){return n.json()}).then(function(r){return t.val(r.value),t.addClass("valid"),M.updateTextFields(),f.slideDown(),e.slideDown(),i.focus(),M.toast({html:"RUT válido",classes:"rounded"}),n.parsley().reset(),!0}).catch(function(t){n.addError("rut",{message:"RUT inválido",updateClass:!0});throw t;}).finally(loaderStop))},messages:{es:"RUT inválido"}});Parsley.addValidator("carnet",{validateString:function(t){var e=n.val(),u,s,h,c,f;return e?(h=$.validateRut(e,function(n,t){u=n;s=t},{minimumLength:r}),!h||u>3e7)?!1:(loaderStart(),c=$("#IsExt").prop("checked"),f=fetch("/SP/DocumentRequestStatus",{method:"POST",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}),body:"__RequestVerificationToken="+$('input[name="__RequestVerificationToken"]').val()+("&rut="+u)+("&dv="+s.replace(/k/,"K"))+("&carnet="+t.replace(/\./g,""))+("&isExt="+c)}).then(function(n){return n.text()}).then(function(t){M.updateTextFields();var r=t==="true";return r?(o.focus(),M.toast({html:"Cédula válida",classes:"rounded"}),i.parsley().reset()):(M.toast({html:"Cédula inválida",classes:"rounded danger"}),n.addError("carnet",{message:"Cédula inválida",updateClass:!0})),r}).catch(function(t){n.addError("carnet",{message:"Error al validar Carnét",updateClass:!0});throw t;}).finally(loaderStop),console.log(f),f):!1},messages:{es:"Verfique combinación RUT/Carnet"}});n.keyup(function(){f.slideUp();e.slideUp();t.prop("readonly",!0);i.val("");t.val("")}).rut({formatOn:"keyup change",minimumLength:r,validateOn:"change"});M.Collapsible.init(document.querySelectorAll(".collapsible"))});